var ThreeSixty,
  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ThreeSixty = (function() {
  ThreeSixty.prototype.Scale = 10;

  ThreeSixty.prototype.MaxRotation = Math.PI / 9.5;

  ThreeSixty.prototype.LEFT = 'left';

  ThreeSixty.prototype.RIGHT = 'right';

  ThreeSixty.prototype.UP = 'up';

  ThreeSixty.prototype.DOWN = 'down';

  ThreeSixty.prototype.IN = 'in';

  ThreeSixty.prototype.OUT = 'out';

  ThreeSixty.prototype.RESET = 'reset';

  function ThreeSixty(box, urls) {
    this.render = bind(this.render, this);
    this.shouldRerender = bind(this.shouldRerender, this);
    this.processMovements = bind(this.processMovements, this);
    this.quadraticEaseInEaseOut = bind(this.quadraticEaseInEaseOut, this);
    this.processPanTo = bind(this.processPanTo, this);
    this.startRender = bind(this.startRender, this);
    this.clampRotation = bind(this.clampRotation, this);
    this.clampPosition = bind(this.clampPosition, this);
    this.move = bind(this.move, this);
    this.getDirection = bind(this.getDirection, this);
    this.beginKeyPress = bind(this.beginKeyPress, this);
    this.endKeyPress = bind(this.endKeyPress, this);
    this.calculateRaycastAngle = bind(this.calculateRaycastAngle, this);
    this.updateMouseRaycast = bind(this.updateMouseRaycast, this);
    this.eventMouseUp = bind(this.eventMouseUp, this);
    this.eventMouseMove = bind(this.eventMouseMove, this);
    this.eventMouseDown = bind(this.eventMouseDown, this);
    this.eventOnKeyUp = bind(this.eventOnKeyUp, this);
    this.eventOnKeyDown = bind(this.eventOnKeyDown, this);
    this.eventDoDomControl = bind(this.eventDoDomControl, this);
    this.initControls = bind(this.initControls, this);
    this.initRenderer = bind(this.initRenderer, this);
    this.initObjects = bind(this.initObjects, this);
    this.initScene = bind(this.initScene, this);
    this.urls = urls;
    this.box = box;
    this.directions = {};
    this.grab = {
      active: false,
      position: new THREE.Vector2(),
      raycast: {
        old: new THREE.Vector3(),
        "new": new THREE.Vector3()
      },
      queue: []
    };
    this.panTo = {
      active: false,
      time: {
        start: 0,
        end: 0
      },
      from: {
        rotation: {
          x: 0,
          y: 0,
          z: 0
        }
      },
      to: {
        rotation: {
          x: 0,
          y: 0,
          z: 0
        }
      }
    };
    this.isRendering = false;
    this.compassNeedle = document.getElementById('compass-direction-icon');
  }

  ThreeSixty.prototype.start = function() {
    this.initScene((function(_this) {
      return function() {
        _this.initObjects(function() {
          _this.initRenderer(function() {
            _this.initControls(function() {
              _this.doRender();
            });
          });
        });
      };
    })(this));
  };

  ThreeSixty.prototype.initScene = function(cb) {
    this.scene = new THREE.Scene;
    this.camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, ThreeSixty.prototype.Scale * 10);
    this.parentObject = new THREE.Object3D();
    this.parentObject.rotation.order = 'YXZ';
    this.scene.add(this.parentObject);
    this.parentObject.add(this.camera);
    this.raycaster = new THREE.Raycaster();
    this.camera.rotation.order = 'YXZ';
    window.addEventListener('resize', ((function(_this) {
      return function() {
        _this.camera.aspect = window.innerWidth / window.innerHeight;
        _this.camera.updateProjectionMatrix();
        _this.renderer.setSize(window.innerWidth, window.innerHeight);
        _this.doRender();
      };
    })(this)), false);
    return cb();
  };

  ThreeSixty.prototype.initObjects = function(cb) {
    return THREE.ImageUtils.loadTextureCube(this.urls, null, (function(_this) {
      return function(texture) {
        var material, meshGeometry, shader, uniforms;
        shader = THREE.ShaderLib['cube'];
        uniforms = THREE.UniformsUtils.clone(shader.uniforms);
        uniforms['tCube'].value = texture;
        material = new THREE.ShaderMaterial({
          fragmentShader: shader.fragmentShader,
          vertexShader: shader.vertexShader,
          uniforms: uniforms,
          side: THREE.BackSide
        });
        meshGeometry = new THREE.SphereGeometry(ThreeSixty.prototype.Scale, 32, 32);
        _this.skyBox = new THREE.Mesh(meshGeometry, material);
        _this.scene.add(_this.skyBox);
        return cb();
      };
    })(this));
  };

  ThreeSixty.prototype.initRenderer = function(cb) {
    this.renderer = new THREE.WebGLRenderer();
    this.renderer.setSize(window.innerWidth, window.innerHeight);
    this.box.appendChild(this.renderer.domElement);
    return cb();
  };

  ThreeSixty.prototype.initControls = function(cb) {
    var fn, i, len, mapControl, mapControls;
    document.addEventListener('keydown', this.eventOnKeyDown, false);
    document.addEventListener('keyup', this.eventOnKeyUp, false);
    this.renderer.domElement.addEventListener('mousedown', this.eventMouseDown, false);
    this.renderer.domElement.addEventListener('mousemove', this.eventMouseMove, false);
    this.renderer.domElement.addEventListener('mouseup', this.eventMouseUp, false);
    this.renderer.domElement.addEventListener('mouseout', this.eventMouseUp, false);
    mapControls = document.querySelectorAll('[data-map-control]');
    fn = (function(_this) {
      return function(mapControl) {
        var direction;
        direction = mapControl.dataset.mapControl;
        return mapControl.addEventListener('click', function(e) {
          e.preventDefault();
          _this.eventDoDomControl(direction);
        });
      };
    })(this);
    for (i = 0, len = mapControls.length; i < len; i++) {
      mapControl = mapControls[i];
      fn(mapControl);
    }
    return cb();
  };

  ThreeSixty.prototype.eventDoDomControl = function(operation) {
    var fromRotation;
    this.panTo.time.start = (new Date()).getTime();
    this.panTo.time.end = this.panTo.time.start + 700;
    fromRotation = this.parentObject.rotation.clone();
    this.panTo.from.rotation = fromRotation;
    this.panTo.to.rotation = fromRotation.clone();
    this.panTo.from.position = this.camera.position.z;
    this.panTo.to.position = this.panTo.from.position;
    switch (operation) {
      case ThreeSixty.prototype.LEFT:
        this.panTo.to.rotation.y = this.panTo.from.rotation.y + Math.PI / 2;
        break;
      case ThreeSixty.prototype.RIGHT:
        this.panTo.to.rotation.y = this.panTo.from.rotation.y - Math.PI / 2;
        break;
      case ThreeSixty.prototype.IN:
        this.panTo.to.position -= 1;
        break;
      case ThreeSixty.prototype.OUT:
        this.panTo.to.position += 1;
        break;
      case ThreeSixty.prototype.RESET:
        this.parentObject.rotation.y = this.parentObject.rotation.y % (2 * Math.PI);
        this.panTo.to.rotation.x = 0;
        this.panTo.to.rotation.y = 0;
        this.panTo.to.position = 0;
        break;
      default:
        console.log("can't do " + operation);
        return;
    }
    this.panTo.to.position = this.clampPosition(this.panTo.to.position);
    this.clampRotation(this.panTo.to);
    this.panTo.active = true;
    this.startRender();
  };

  ThreeSixty.prototype.eventOnKeyDown = function(e) {
    var dir;
    dir = this.getDirection(e.keyCode);
    if (dir != null) {
      e.preventDefault();
      this.beginKeyPress(dir);
    }
  };

  ThreeSixty.prototype.eventOnKeyUp = function(e) {
    var dir;
    dir = this.getDirection(e.keyCode);
    if (dir != null) {
      this.endKeyPress(dir);
    }
  };

  ThreeSixty.prototype.eventMouseDown = function(e) {
    this.grab.active = true;
    this.grab.position.x = (e.clientX / window.innerWidth) * 2 - 1;
    this.grab.position.y = -(e.clientY / window.innerHeight) * 2 + 1;
    this.updateMouseRaycast();
    this.grab.raycast.old = this.grab.raycast["new"];
    this.startRender();
  };

  ThreeSixty.prototype.eventMouseMove = function(e) {
    if (this.grab.active) {
      this.grab.position.x = (e.clientX / window.innerWidth) * 2 - 1;
      this.grab.position.y = -(e.clientY / window.innerHeight) * 2 + 1;
      this.updateMouseRaycast();
      this.calculateRaycastAngle();
    }
  };

  ThreeSixty.prototype.eventMouseUp = function() {
    this.grab.active = false;
  };

  ThreeSixty.prototype.updateMouseRaycast = function() {
    var raycastPoint;
    this.raycaster.setFromCamera(this.grab.position, this.camera);
    raycastPoint = this.raycaster.intersectObject(this.skyBox)[0];
    console.log(raycastPoint.point);
    this.grab.raycast["new"] = raycastPoint.point.normalize();
  };

  ThreeSixty.prototype.calculateRaycastAngle = function() {
    var eulerOrder, oldRot, qRot;
    qRot = new THREE.Quaternion();
    qRot.setFromUnitVectors(this.grab.raycast["new"], this.grab.raycast.old);
    oldRot = new THREE.Quaternion();
    oldRot.setFromEuler(this.parentObject.rotation);
    qRot.multiply(oldRot);
    eulerOrder = this.parentObject.rotation.order;
    this.parentObject.rotation.setFromQuaternion(qRot, eulerOrder);
    this.parentObject.rotation.z = 0;
    this.clampRotation(this.parentObject);
  };

  ThreeSixty.prototype.endKeyPress = function(direction) {
    if (this.directions[direction]) {
      return this.directions[direction] = false;
    }
  };

  ThreeSixty.prototype.beginKeyPress = function(direction) {
    if (this.directions[direction]) {
      return;
    }
    this.directions[direction] = true;
    return this.startRender();
  };

  ThreeSixty.prototype.getDirection = function(key) {
    switch (key) {
      case 37:
      case 65:
        return ThreeSixty.prototype.LEFT;
      case 38:
      case 87:
        return ThreeSixty.prototype.UP;
      case 39:
      case 68:
        return ThreeSixty.prototype.RIGHT;
      case 40:
      case 83:
        return ThreeSixty.prototype.DOWN;
      case 187:
        return ThreeSixty.prototype.IN;
      case 189:
        return ThreeSixty.prototype.OUT;
      default:
        return false;
    }
  };

  ThreeSixty.prototype.move = function(direction) {
    switch (direction) {
      case ThreeSixty.prototype.LEFT:
        this.parentObject.rotation.y += Math.PI / 200;
        break;
      case ThreeSixty.prototype.UP:
        this.parentObject.rotation.x += Math.PI / 200;
        break;
      case ThreeSixty.prototype.RIGHT:
        this.parentObject.rotation.y -= Math.PI / 200;
        break;
      case ThreeSixty.prototype.DOWN:
        this.parentObject.rotation.x -= Math.PI / 200;
        break;
      case ThreeSixty.prototype.IN:
        this.camera.position.z += ThreeSixty.prototype.Scale / -100;
        break;
      case ThreeSixty.prototype.OUT:
        this.camera.position.z += ThreeSixty.prototype.Scale / 100;
        break;
      default:
        null;
    }
    this.camera.position.z = this.clampPosition(this.camera.position.z);
    this.clampRotation(this.parentObject);
  };

  ThreeSixty.prototype.clampPosition = function(position) {
    if (position < ThreeSixty.prototype.Scale * -0.4) {
      return ThreeSixty.prototype.Scale * -0.4;
    } else if (position > 0) {
      return 0;
    } else {
      return position;
    }
  };

  ThreeSixty.prototype.clampRotation = function(object) {
    if (object.rotation.x > ThreeSixty.prototype.MaxRotation) {
      object.rotation.x = ThreeSixty.prototype.MaxRotation;
    }
    if (object.rotation.x < -ThreeSixty.prototype.MaxRotation) {
      object.rotation.x = -ThreeSixty.prototype.MaxRotation;
    }
  };

  ThreeSixty.prototype.startRender = function() {
    if (!this.isRendering) {
      this.isRendering = true;
      this.render();
    }
  };

  ThreeSixty.prototype.processPanTo = function() {
    var Tc;
    Tc = (new Date()).getTime();
    if (this.parentObject.rotation.y !== this.panTo.to.rotation.y) {
      this.parentObject.rotation.y = this.quadraticEaseInEaseOut(Tc, this.panTo.to.rotation.y, this.panTo.from.rotation.y);
    }
    if (this.parentObject.rotation.x !== this.panTo.to.rotation.x) {
      this.parentObject.rotation.x = this.quadraticEaseInEaseOut(Tc, this.panTo.to.rotation.x, this.panTo.from.rotation.x);
    }
    if (this.camera.position.z !== this.panTo.to.position) {
      this.camera.position.z = this.quadraticEaseInEaseOut(Tc, this.panTo.to.position, this.panTo.from.position);
    }
    if (Tc >= this.panTo.time.end) {
      this.parentObject.rotation.y = this.panTo.to.rotation.y;
      this.parentObject.rotation.x = this.panTo.to.rotation.x;
      this.camera.position.z = this.panTo.to.position;
      this.panTo.active = false;
    }
  };

  ThreeSixty.prototype.quadraticEaseInEaseOut = function(Tc, G, B) {
    var t;
    t = 2 * (Tc - this.panTo.time.start) / (this.panTo.time.end - this.panTo.time.start);
    if (t < 1) {
      return ((G - B) / 2) * t * t + B;
    } else {
      t = t - 1;
      return ((B - G) / 2) * (t * (t - 2) - 1) + B;
    }
  };

  ThreeSixty.prototype.processMovements = function() {
    var rotationString;
    _.map(this.directions, (function(_this) {
      return function(enabled, direction) {
        if (enabled) {
          return _this.move(direction);
        }
      };
    })(this));
    if (this.panTo.active) {
      this.processPanTo();
    }
    rotationString = "rotate(" + this.parentObject.rotation.y + "rad)";
    this.compassNeedle.style.webkitTransform = rotationString;
    this.compassNeedle.style.transform = rotationString;
  };

  ThreeSixty.prototype.shouldRerender = function() {
    return this.grab.active || _.some(this.directions) || this.panTo.active;
  };

  ThreeSixty.prototype.doRender = function() {
    return this.renderer.render(this.scene, this.camera);
  };

  ThreeSixty.prototype.render = function() {
    if (this.shouldRerender()) {
      requestAnimationFrame(ThreeSixty.prototype.render.bind(this));
      this.processMovements();
      this.doRender();
    } else {
      this.isRendering = false;
    }
  };

  return ThreeSixty;

})();

document.addEventListener('DOMContentLoaded', function() {
  var ts;
  ts = new ThreeSixty(document.body, ['images/yokohama/pos-x.jpg', 'images/yokohama/neg-x.jpg', 'images/yokohama/pos-y.jpg', 'images/yokohama/neg-y.jpg', 'images/yokohama/pos-z.jpg', 'images/yokohama/neg-z.jpg']);
  ts.start();
});

//# sourceMappingURL=data:application/json;base64,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LDJCQURpQyxFQUVqQywyQkFGaUMsRUFHakMsMkJBSGlDLEVBSWpDLDJCQUppQyxFQUtqQywyQkFMaUMsRUFNakMsMkJBTmlDLENBQTFCO0VBU1QsRUFBRSxDQUFDLEtBQUgsQ0FBQTtBQVY0QyxDQUE5QyIsImZpbGUiOiJ0aHJlZXNpeHR5Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRocmVlU2l4dHlcblxuICBTY2FsZTogMTBcblxuICBNYXhSb3RhdGlvbjogTWF0aC5QSS85LjVcblxuICAjIERpcmVjdGlvbiBjb25zdGFudHNcbiAgTEVGVDogJ2xlZnQnXG4gIFJJR0hUOiAncmlnaHQnXG4gIFVQOiAndXAnXG4gIERPV046ICdkb3duJ1xuICBJTjogJ2luJ1xuICBPVVQ6ICdvdXQnXG4gIFJFU0VUOiAncmVzZXQnXG5cbiAgY29uc3RydWN0b3I6IChib3gsIHVybHMpIC0+XG4gICAgQHVybHMgPSB1cmxzXG4gICAgQGJveCA9IGJveFxuXG4gICAgQGRpcmVjdGlvbnMgPSB7fVxuXG4gICAgQGdyYWIgPVxuICAgICAgYWN0aXZlOiBmYWxzZVxuICAgICAgcG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IyKClcbiAgICAgIHJheWNhc3Q6XG4gICAgICAgIG9sZDogbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgICAgICBuZXc6IG5ldyBUSFJFRS5WZWN0b3IzKClcbiAgICAgIHF1ZXVlOiBbXVxuXG4gICAgQHBhblRvID1cbiAgICAgIGFjdGl2ZTogZmFsc2VcbiAgICAgIHRpbWU6XG4gICAgICAgIHN0YXJ0OiAwXG4gICAgICAgIGVuZDogMFxuICAgICAgZnJvbTpcbiAgICAgICAgcm90YXRpb246XG4gICAgICAgICAgeDogMFxuICAgICAgICAgIHk6IDBcbiAgICAgICAgICB6OiAwXG4gICAgICB0bzpcbiAgICAgICAgcm90YXRpb246XG4gICAgICAgICAgeDogMFxuICAgICAgICAgIHk6IDBcbiAgICAgICAgICB6OiAwXG5cbiAgICBAaXNSZW5kZXJpbmcgPSBmYWxzZVxuXG4gICAgQGNvbXBhc3NOZWVkbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCAnY29tcGFzcy1kaXJlY3Rpb24taWNvbidcblxuICBzdGFydDogLT5cbiAgICAjIENyZWF0ZSB0aGUgc2NlbmVcbiAgICBAaW5pdFNjZW5lID0+XG4gICAgICAjIEFkZCB0aGUgb2JqZWN0cyB0byByZW5kZXJcbiAgICAgIEBpbml0T2JqZWN0cyA9PlxuICAgICAgICAjIEFkZCB0aGUgcmVuZGVyZXJcbiAgICAgICAgQGluaXRSZW5kZXJlciA9PlxuICAgICAgICAgICMgQWRkIHRoZSBjYWxsYmFja3MgZm9yIG1hbmFnZW1lbnRcbiAgICAgICAgICBAaW5pdENvbnRyb2xzID0+XG4gICAgICAgICAgICAjIEZvcmNlIGEgcmVuZGVyXG4gICAgICAgICAgICBAZG9SZW5kZXIoKVxuXG4gICAgICAgICAgICByZXR1cm5cblxuICAgICAgICAgIHJldHVyblxuXG4gICAgICAgIHJldHVyblxuXG4gICAgICByZXR1cm5cblxuICAgIHJldHVyblxuXG4gIGluaXRTY2VuZTogKGNiKSA9PlxuICAgICMgSW5pdCBTY2VuZVxuICAgIEBzY2VuZSA9IG5ldyAoVEhSRUUuU2NlbmUpXG5cbiAgICAjIEluaXQgQ2FtZXJhXG4gICAgQGNhbWVyYSA9IG5ldyAoVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEpKDcwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMSwgVGhyZWVTaXh0eTo6U2NhbGUgKiAxMClcblxuICAgIEBwYXJlbnRPYmplY3QgPSBuZXcgVEhSRUUuT2JqZWN0M0QoKVxuICAgIEBwYXJlbnRPYmplY3Qucm90YXRpb24ub3JkZXIgPSAnWVhaJ1xuICAgIEBzY2VuZS5hZGQgQHBhcmVudE9iamVjdFxuXG4gICAgQHBhcmVudE9iamVjdC5hZGQgQGNhbWVyYVxuXG4gICAgQHJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKVxuXG4gICAgIyBCZWNhdXNlIHdlIGRvbid0IHJvdGF0ZSBpbiB0aGUgWiBkaXJlY3Rpb24sIHRoaXMgd2lsbCBiZSBhIG5hdHVyYWwgcm90YXRpb24gb3JkZXJcbiAgICBAY2FtZXJhLnJvdGF0aW9uLm9yZGVyID0gJ1lYWidcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICdyZXNpemUnLCAoKCkgPT5cbiAgICAgICMgQ29ycmVjdCB0aGUgY2FtZXJhJ3MgYXNwZWN0IHJhdGlvXG4gICAgICBAY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0XG4gICAgICBAY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKVxuXG4gICAgICAjIEFkanVzdCB0aGUgcmVuZGVyZXIgc2l6ZVxuICAgICAgQHJlbmRlcmVyLnNldFNpemUgd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodFxuXG4gICAgICAjIFJlLXJlbmRlciB0aGlzIG9uZSB0aW1lXG4gICAgICBAZG9SZW5kZXIoKVxuXG4gICAgICAjIEV4aXRcbiAgICAgIHJldHVyblxuICAgICksIGZhbHNlXG5cbiAgICBjYigpXG5cbiAgaW5pdE9iamVjdHM6IChjYikgPT5cbiAgICBUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlQ3ViZSBAdXJscywgbnVsbCwgKHRleHR1cmUpID0+XG4gICAgICAjIGluaXQgdGhlIGN1YmUgc2hhZGRlclxuICAgICAgc2hhZGVyID0gVEhSRUUuU2hhZGVyTGliWydjdWJlJ11cblxuICAgICAgIyBTZXR1cCB0aGUgdW5pZm9ybVxuICAgICAgdW5pZm9ybXMgPSBUSFJFRS5Vbmlmb3Jtc1V0aWxzLmNsb25lKHNoYWRlci51bmlmb3JtcylcbiAgICAgIHVuaWZvcm1zWyd0Q3ViZSddLnZhbHVlID0gdGV4dHVyZVxuXG4gICAgICAjIGNhbWVyYXRlIHRoZSBtYXRlcmlhbFxuICAgICAgbWF0ZXJpYWwgPSBuZXcgKFRIUkVFLlNoYWRlck1hdGVyaWFsKShcbiAgICAgICAgZnJhZ21lbnRTaGFkZXI6IHNoYWRlci5mcmFnbWVudFNoYWRlclxuICAgICAgICB2ZXJ0ZXhTaGFkZXI6IHNoYWRlci52ZXJ0ZXhTaGFkZXJcbiAgICAgICAgdW5pZm9ybXM6IHVuaWZvcm1zXG4gICAgICAgIHNpZGU6IFRIUkVFLkJhY2tTaWRlKVxuXG4gICAgICAjIG1hdGVyaWFsLndpcmVmcmFtZSA9IHRydWVcblxuICAgICAgIyBHZW5lcmF0ZSBhIHNwaGVyZSBnZW9tZXRyeVxuICAgICAgbWVzaEdlb21ldHJ5ID0gbmV3IChUSFJFRS5TcGhlcmVHZW9tZXRyeSkoVGhyZWVTaXh0eTo6U2NhbGUsIDMyLCAzMilcblxuICAgICAgIyBidWlsZCB0aGUgc2t5Ym94IE1lc2ggdXNpbmcgdGhlIHRleHR1cmUgY3ViZVxuICAgICAgQHNreUJveCA9IG5ldyAoVEhSRUUuTWVzaCkobWVzaEdlb21ldHJ5LCBtYXRlcmlhbClcblxuICAgICAgIyBhbmQgYWRkIGl0IHRvIHRoZSBzY2VuZVxuICAgICAgQHNjZW5lLmFkZCBAc2t5Qm94XG5cbiAgICAgIGNiKClcblxuICBpbml0UmVuZGVyZXI6IChjYikgPT5cbiAgICBAcmVuZGVyZXIgPSBuZXcgKFRIUkVFLldlYkdMUmVuZGVyZXIpKClcbiAgICBAcmVuZGVyZXIuc2V0U2l6ZSB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0XG4gICAgQGJveC5hcHBlbmRDaGlsZCBAcmVuZGVyZXIuZG9tRWxlbWVudFxuXG4gICAgY2IoKVxuXG4gIGluaXRDb250cm9sczogKGNiKSA9PlxuICAgICMgS2V5Ym9hcmQgc2hvcnRjdXRzXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAna2V5ZG93bicsIEBldmVudE9uS2V5RG93biwgZmFsc2VcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdrZXl1cCcsIEBldmVudE9uS2V5VXAsIGZhbHNlXG5cbiAgICAjIE1vdXNlIGRyYWdnaW5nXG4gICAgQHJlbmRlcmVyLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAnbW91c2Vkb3duJywgQGV2ZW50TW91c2VEb3duLCBmYWxzZVxuICAgIEByZW5kZXJlci5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIgJ21vdXNlbW92ZScsIEBldmVudE1vdXNlTW92ZSwgZmFsc2VcbiAgICBAcmVuZGVyZXIuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyICdtb3VzZXVwJywgQGV2ZW50TW91c2VVcCwgZmFsc2VcbiAgICBAcmVuZGVyZXIuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyICdtb3VzZW91dCcsIEBldmVudE1vdXNlVXAsIGZhbHNlXG5cbiAgICBtYXBDb250cm9scyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwgJ1tkYXRhLW1hcC1jb250cm9sXSdcblxuICAgIGZvciBtYXBDb250cm9sIGluIG1hcENvbnRyb2xzXG4gICAgICBkbyAobWFwQ29udHJvbCkgPT5cbiAgICAgICAgZGlyZWN0aW9uID0gbWFwQ29udHJvbC5kYXRhc2V0Lm1hcENvbnRyb2xcblxuICAgICAgICBtYXBDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIgJ2NsaWNrJywgKGUpID0+XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAgICAgICBAZXZlbnREb0RvbUNvbnRyb2wgZGlyZWN0aW9uXG5cbiAgICAgICAgICByZXR1cm5cblxuICAgIGNiKClcblxuICBldmVudERvRG9tQ29udHJvbDogKG9wZXJhdGlvbikgPT5cbiAgICBAcGFuVG8udGltZS5zdGFydCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKClcbiAgICBAcGFuVG8udGltZS5lbmQgPSBAcGFuVG8udGltZS5zdGFydCArIDcwMFxuXG4gICAgIyBnZXQgdGhlIGN1cnJlbnQgY2FtZXJhIHJvdGF0aW9uXG4gICAgZnJvbVJvdGF0aW9uID0gQHBhcmVudE9iamVjdC5yb3RhdGlvbi5jbG9uZSgpXG5cbiAgICBAcGFuVG8uZnJvbS5yb3RhdGlvbiA9IGZyb21Sb3RhdGlvblxuICAgIEBwYW5Uby50by5yb3RhdGlvbiA9IGZyb21Sb3RhdGlvbi5jbG9uZSgpXG5cbiAgICBAcGFuVG8uZnJvbS5wb3NpdGlvbiA9IEBjYW1lcmEucG9zaXRpb24uelxuICAgIEBwYW5Uby50by5wb3NpdGlvbiA9IEBwYW5Uby5mcm9tLnBvc2l0aW9uXG5cbiAgICBzd2l0Y2ggb3BlcmF0aW9uXG4gICAgICB3aGVuIFRocmVlU2l4dHk6OkxFRlRcbiAgICAgICAgIyBtb3ZlIHVzIFBJLzIgaW4gdGhlICtZIGRpcmVjdGlvblxuICAgICAgICBAcGFuVG8udG8ucm90YXRpb24ueSA9IEBwYW5Uby5mcm9tLnJvdGF0aW9uLnkgKyBNYXRoLlBJLzJcbiAgICAgIHdoZW4gVGhyZWVTaXh0eTo6UklHSFRcbiAgICAgICAgIyBtb3ZlIHVzIFBJLzIgaW4gdGhlIC1ZIGRpcmVjdGlvblxuICAgICAgICBAcGFuVG8udG8ucm90YXRpb24ueSA9IEBwYW5Uby5mcm9tLnJvdGF0aW9uLnkgLSBNYXRoLlBJLzJcbiAgICAgIHdoZW4gVGhyZWVTaXh0eTo6SU5cbiAgICAgICAgQHBhblRvLnRvLnBvc2l0aW9uIC09IDFcbiAgICAgIHdoZW4gVGhyZWVTaXh0eTo6T1VUXG4gICAgICAgIEBwYW5Uby50by5wb3NpdGlvbiArPSAxXG4gICAgICB3aGVuIFRocmVlU2l4dHk6OlJFU0VUXG4gICAgICAgIEBwYXJlbnRPYmplY3Qucm90YXRpb24ueSA9IEBwYXJlbnRPYmplY3Qucm90YXRpb24ueSAlICgyICogTWF0aC5QSSlcblxuICAgICAgICBAcGFuVG8udG8ucm90YXRpb24ueCA9IDBcbiAgICAgICAgQHBhblRvLnRvLnJvdGF0aW9uLnkgPSAwXG4gICAgICAgIEBwYW5Uby50by5wb3NpdGlvbiA9IDBcbiAgICAgIGVsc2VcbiAgICAgICAgY29uc29sZS5sb2cgXCJjYW4ndCBkbyAje29wZXJhdGlvbn1cIlxuICAgICAgICByZXR1cm5cblxuICAgIEBwYW5Uby50by5wb3NpdGlvbiA9IEBjbGFtcFBvc2l0aW9uKEBwYW5Uby50by5wb3NpdGlvbilcbiAgICBAY2xhbXBSb3RhdGlvbihAcGFuVG8udG8pXG5cbiAgICAjIG1hcmsgdGhlIHBhbm5pbmcgYXMgYWN0aXZlXG4gICAgQHBhblRvLmFjdGl2ZSA9IHRydWVcblxuICAgICMgYmVnaW4gdGhlIHJlbmRlclxuICAgIEBzdGFydFJlbmRlcigpXG5cbiAgICByZXR1cm5cblxuICBldmVudE9uS2V5RG93bjogKGUpID0+XG4gICAgIyBHZXQgdGhlIGRpcmVjdGlvblxuICAgIGRpciA9IEBnZXREaXJlY3Rpb24gZS5rZXlDb2RlXG5cbiAgICAjIElmIHRoaXMgaXMgYSBkaXJlY3Rpb24ga2V5Li4uXG4gICAgaWYgZGlyP1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAgICMgUGVyZm9ybSBpdCdzIGFjdGlvblxuICAgICAgQGJlZ2luS2V5UHJlc3MgZGlyXG5cbiAgICAgICMgQW5kIGZpbmlzaFxuICAgICAgcmV0dXJuXG5cbiAgZXZlbnRPbktleVVwOiAoZSkgPT5cbiAgICAjIEdldCB0aGUgZGlyZWN0aW9uXG4gICAgZGlyID0gQGdldERpcmVjdGlvbiBlLmtleUNvZGVcblxuICAgICMgSWYgdGhpcyBpcyBhIGRpcmVjdGlvbiBrZXkuLi5cbiAgICBpZiBkaXI/XG4gICAgICAjIFBlcmZvcm0gaXQncyBhY3Rpb25cbiAgICAgIEBlbmRLZXlQcmVzcyBkaXJcblxuICAgICAgIyBBbmQgZmluaXNoXG4gICAgICByZXR1cm5cblxuICBldmVudE1vdXNlRG93bjogKGUpID0+XG4gICAgQGdyYWIuYWN0aXZlID0gdHJ1ZVxuXG4gICAgIyBTdGFydCBkcmFnLWJhc2VkIHJvdGF0aW9uLiBXZSByYXljYXN0IGEgcG9pbnQgb24gdGhlIG91dGVyIHNwaGVyZSBhcyBvdXIgcmVmZXJlbmNlLFxuICAgICMgYmFzZWQgb24gd2hlcmUgdGhlIHVzZXIgaGFzIGNsaWNrZWQuIFRoaXMgaXMgc3RvcmVkIGFzIEBncmFiLnJheWNhc3Qub2xkLlxuICAgICMgSW4gZXZlbnRNb3VzZU1vdmUsIHdlIHJheWNhc3QgYWdhaW4sIGZpbmQgdGhlIG5ldyBwb2ludCBvbiB0aGUgc3BoZXJlLCBhbmQgY2FsY3VsYXRlXG4gICAgIyB0aGUgcm90YXRpb24gcmVxdWlyZWQgdG8gcm90YXRlIHRoZSByZWZlcmVuY2UgcG9pbnQgdG8gdGhhdCBsb2NhdGlvbi4gVGhpc1xuICAgICMgcm90YXRpb24gaXMgYXBwbGllZCB0byB0aGUgY2FtZXJhLCBleGNlcHQgZm9yIHRoZSBaIGNvbXBvbmVudCwgd2hpY2ggd291bGQgYmUgdmVyeVxuICAgICMgY29uZnVzaW5nLlxuICAgIEBncmFiLnBvc2l0aW9uLnggPSAoIGUuY2xpZW50WCAvIHdpbmRvdy5pbm5lcldpZHRoICkgKiAyIC0gMTtcbiAgICBAZ3JhYi5wb3NpdGlvbi55ID0gLSAoIGUuY2xpZW50WSAvIHdpbmRvdy5pbm5lckhlaWdodCApICogMiArIDE7XG4gICAgQHVwZGF0ZU1vdXNlUmF5Y2FzdCgpXG4gICAgQGdyYWIucmF5Y2FzdC5vbGQgPSBAZ3JhYi5yYXljYXN0Lm5ld1xuXG4gICAgQHN0YXJ0UmVuZGVyKClcblxuICAgIHJldHVyblxuXG4gIGV2ZW50TW91c2VNb3ZlOiAoZSkgPT5cbiAgICBpZiBAZ3JhYi5hY3RpdmVcbiAgICAgIEBncmFiLnBvc2l0aW9uLnggPSAoIGUuY2xpZW50WCAvIHdpbmRvdy5pbm5lcldpZHRoICkgKiAyIC0gMTtcbiAgICAgIEBncmFiLnBvc2l0aW9uLnkgPSAtICggZS5jbGllbnRZIC8gd2luZG93LmlubmVySGVpZ2h0ICkgKiAyICsgMTtcblxuICAgICAgQHVwZGF0ZU1vdXNlUmF5Y2FzdCgpXG5cbiAgICAgIEBjYWxjdWxhdGVSYXljYXN0QW5nbGUoKVxuXG4gICAgcmV0dXJuXG5cbiAgZXZlbnRNb3VzZVVwOiAoKSA9PlxuICAgIEBncmFiLmFjdGl2ZSA9IGZhbHNlXG4gICAgcmV0dXJuXG5cbiAgdXBkYXRlTW91c2VSYXljYXN0OiAoKSA9PlxuICAgIEByYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSBAZ3JhYi5wb3NpdGlvbiwgQGNhbWVyYVxuXG4gICAgcmF5Y2FzdFBvaW50ID0gQHJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3QoQHNreUJveClbMF1cblxuICAgIGNvbnNvbGUubG9nIHJheWNhc3RQb2ludC5wb2ludFxuXG4gICAgQGdyYWIucmF5Y2FzdC5uZXcgPSByYXljYXN0UG9pbnQucG9pbnQubm9ybWFsaXplKClcblxuICAgIHJldHVyblxuXG4gIGNhbGN1bGF0ZVJheWNhc3RBbmdsZTogKCkgPT5cbiAgICAjIGZpbmQgYW5nbGUgYmV0d2VlbiB3aGVyZSB0aGUgbW91c2UgcmF5IGhpdHMgdGhlIHNwaGVyZSBhbmQgd2hlcmUgd2Ugd2FudCBpdFxuICAgICMgdG8gaGl0ICh0aGUgc3BvdCBvbiB0aGUgc3BoZXJlIHRoYXQgd2FzIG9yaWdpbmFsbHkgZ3JhYmJlZCkuXG4gICAgcVJvdCA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKClcbiAgICBxUm90LnNldEZyb21Vbml0VmVjdG9ycyBAZ3JhYi5yYXljYXN0Lm5ldywgQGdyYWIucmF5Y2FzdC5vbGRcblxuICAgICMgbm93IHdlIHJvdGF0ZSB0aGUgY2FtZXJhIHNvIHRoYXQgaWYgd2UgZGlkIHRoZSByYXkgY2FzdCBhZ2Fpbiwgd2Ugd291bGQgaGl0XG4gICAgIyBvdXIgcmVmZXJlbmNlIHBvaW50ICh3aGVyZSB0aGUgdXNlciBncmFiYmVkKVxuXG4gICAgIyBhZGQgdGhlIG5ldyByb3RhdGlvbiB0byBvdXIgb3JpZ2luYWxcbiAgICBvbGRSb3QgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpXG4gICAgb2xkUm90LnNldEZyb21FdWxlciBAcGFyZW50T2JqZWN0LnJvdGF0aW9uXG5cbiAgICBxUm90Lm11bHRpcGx5IG9sZFJvdFxuXG4gICAgZXVsZXJPcmRlciA9IEBwYXJlbnRPYmplY3Qucm90YXRpb24ub3JkZXJcbiAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnNldEZyb21RdWF0ZXJuaW9uIHFSb3QsIGV1bGVyT3JkZXJcblxuICAgICMgbm93IHdlIHRyeSB0byBmaXggdXBcbiAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnogPSAwXG5cbiAgICAjIGNsYW1wIHggcm90YXRpb24gKHBpdGNoKVxuICAgIEBjbGFtcFJvdGF0aW9uKEBwYXJlbnRPYmplY3QpXG4gICAgcmV0dXJuXG5cbiAgZW5kS2V5UHJlc3M6IChkaXJlY3Rpb24pID0+XG4gICAgIyBJZiB3ZSBhcmVuJ3QgdHJhY2tpbmcgaXRcbiAgICBAZGlyZWN0aW9uc1tkaXJlY3Rpb25dID0gZmFsc2UgaWYgQGRpcmVjdGlvbnNbZGlyZWN0aW9uXVxuXG4gIGJlZ2luS2V5UHJlc3M6IChkaXJlY3Rpb24pID0+XG4gICAgIyBJZiB3ZSBhbHJlYWR5IGFyZSBtYW5hZ2luZyB0aGlzIGRpcmVjdGlvblxuICAgIGlmIEBkaXJlY3Rpb25zW2RpcmVjdGlvbl1cbiAgICAgICMgVGhlbiBqdXN0IHJldHVyblxuICAgICAgcmV0dXJuXG5cbiAgICAjIE90aGVyd2lzZSBzZXQgaXQgdG8gdHJ1ZVxuICAgIEBkaXJlY3Rpb25zW2RpcmVjdGlvbl0gPSB0cnVlXG5cbiAgICBAc3RhcnRSZW5kZXIoKVxuXG4gIGdldERpcmVjdGlvbjogKGtleSkgPT5cbiAgICBzd2l0Y2gga2V5XG4gICAgICB3aGVuIDM3LCA2NSB0aGVuIFRocmVlU2l4dHk6OkxFRlRcbiAgICAgIHdoZW4gMzgsIDg3IHRoZW4gVGhyZWVTaXh0eTo6VVBcbiAgICAgIHdoZW4gMzksIDY4IHRoZW4gVGhyZWVTaXh0eTo6UklHSFRcbiAgICAgIHdoZW4gNDAsIDgzIHRoZW4gVGhyZWVTaXh0eTo6RE9XTlxuICAgICAgd2hlbiAxODcgdGhlbiBUaHJlZVNpeHR5OjpJTlxuICAgICAgd2hlbiAxODkgdGhlbiBUaHJlZVNpeHR5OjpPVVRcbiAgICAgIGVsc2UgZmFsc2VcblxuICBtb3ZlOiAoZGlyZWN0aW9uKSA9PlxuICAgIHN3aXRjaCBkaXJlY3Rpb25cbiAgICAgIHdoZW4gVGhyZWVTaXh0eTo6TEVGVFxuICAgICAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnkgKz0gTWF0aC5QSSAvIDIwMFxuICAgICAgd2hlbiBUaHJlZVNpeHR5OjpVUFxuICAgICAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnggKz0gTWF0aC5QSSAvIDIwMFxuICAgICAgd2hlbiBUaHJlZVNpeHR5OjpSSUdIVFxuICAgICAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnkgLT0gTWF0aC5QSSAvIDIwMFxuICAgICAgd2hlbiBUaHJlZVNpeHR5OjpET1dOXG4gICAgICAgIEBwYXJlbnRPYmplY3Qucm90YXRpb24ueCAtPSBNYXRoLlBJIC8gMjAwXG4gICAgICB3aGVuIFRocmVlU2l4dHk6OklOXG4gICAgICAgIEBjYW1lcmEucG9zaXRpb24ueiArPSBUaHJlZVNpeHR5OjpTY2FsZSAvIC0xMDBcbiAgICAgIHdoZW4gVGhyZWVTaXh0eTo6T1VUXG4gICAgICAgIEBjYW1lcmEucG9zaXRpb24ueiArPSBUaHJlZVNpeHR5OjpTY2FsZSAvIDEwMFxuICAgICAgZWxzZSBudWxsXG5cbiAgICBAY2FtZXJhLnBvc2l0aW9uLnogPSBAY2xhbXBQb3NpdGlvbihAY2FtZXJhLnBvc2l0aW9uLnopXG4gICAgQGNsYW1wUm90YXRpb24oQHBhcmVudE9iamVjdClcblxuICAgIHJldHVyblxuXG4gIGNsYW1wUG9zaXRpb246IChwb3NpdGlvbikgPT5cbiAgICBpZiBwb3NpdGlvbiA8IFRocmVlU2l4dHk6OlNjYWxlICogLTAuNFxuICAgICAgVGhyZWVTaXh0eTo6U2NhbGUgKiAtMC40XG4gICAgZWxzZSBpZiBwb3NpdGlvbiA+IDBcbiAgICAgIDBcbiAgICBlbHNlXG4gICAgICBwb3NpdGlvblxuXG4gIGNsYW1wUm90YXRpb246IChvYmplY3QpID0+XG4gICAgaWYgb2JqZWN0LnJvdGF0aW9uLnggPiBUaHJlZVNpeHR5OjpNYXhSb3RhdGlvblxuICAgICAgb2JqZWN0LnJvdGF0aW9uLnggPSBUaHJlZVNpeHR5OjpNYXhSb3RhdGlvblxuXG4gICAgaWYgb2JqZWN0LnJvdGF0aW9uLnggPCAtVGhyZWVTaXh0eTo6TWF4Um90YXRpb25cbiAgICAgIG9iamVjdC5yb3RhdGlvbi54ID0gLVRocmVlU2l4dHk6Ok1heFJvdGF0aW9uXG5cbiAgICByZXR1cm5cblxuICBzdGFydFJlbmRlcjogPT5cbiAgICAjIElmIGl0IGlzIG5vdCByZW5kZXJpbmcuLi5cbiAgICBpZiAhQGlzUmVuZGVyaW5nXG5cbiAgICAgICMgVGhlbiBtYXJrIGl0IGFzIHJlbmRlcmluZ1xuICAgICAgQGlzUmVuZGVyaW5nID0gdHJ1ZVxuXG4gICAgICAjIEFuZCBzdGFydCB0aGUgcmVuZGVyXG4gICAgICBAcmVuZGVyKClcblxuICAgIHJldHVyblxuXG4gIHByb2Nlc3NQYW5UbzogKCkgPT5cbiAgICBUYyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKClcblxuICAgIGlmIEBwYXJlbnRPYmplY3Qucm90YXRpb24ueSAhPSBAcGFuVG8udG8ucm90YXRpb24ueVxuICAgICAgQHBhcmVudE9iamVjdC5yb3RhdGlvbi55ID0gQHF1YWRyYXRpY0Vhc2VJbkVhc2VPdXQoVGMsIEBwYW5Uby50by5yb3RhdGlvbi55LCBAcGFuVG8uZnJvbS5yb3RhdGlvbi55KVxuXG4gICAgaWYgQHBhcmVudE9iamVjdC5yb3RhdGlvbi54ICE9IEBwYW5Uby50by5yb3RhdGlvbi54XG4gICAgICBAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnggPSBAcXVhZHJhdGljRWFzZUluRWFzZU91dChUYywgQHBhblRvLnRvLnJvdGF0aW9uLngsIEBwYW5Uby5mcm9tLnJvdGF0aW9uLngpXG5cbiAgICBpZiBAY2FtZXJhLnBvc2l0aW9uLnogIT0gQHBhblRvLnRvLnBvc2l0aW9uXG4gICAgICBAY2FtZXJhLnBvc2l0aW9uLnogPSBAcXVhZHJhdGljRWFzZUluRWFzZU91dChUYywgQHBhblRvLnRvLnBvc2l0aW9uLCBAcGFuVG8uZnJvbS5wb3NpdGlvbilcblxuICAgIGlmIFRjID49IEBwYW5Uby50aW1lLmVuZFxuICAgICAgQHBhcmVudE9iamVjdC5yb3RhdGlvbi55ID0gQHBhblRvLnRvLnJvdGF0aW9uLnlcbiAgICAgIEBwYXJlbnRPYmplY3Qucm90YXRpb24ueCA9IEBwYW5Uby50by5yb3RhdGlvbi54XG4gICAgICBAY2FtZXJhLnBvc2l0aW9uLnogPSBAcGFuVG8udG8ucG9zaXRpb25cblxuICAgICAgIyBzdG9wIHBhbm5pbmdcbiAgICAgIEBwYW5Uby5hY3RpdmUgPSBmYWxzZVxuXG4gICAgcmV0dXJuXG5cbiAgcXVhZHJhdGljRWFzZUluRWFzZU91dDogKFRjLCBHLCBCKSA9PlxuICAgICMgY29tcHV0ZSB0aW1lXG4gICAgdCA9IDIgKiAoVGMgLSBAcGFuVG8udGltZS5zdGFydCkgLyAoQHBhblRvLnRpbWUuZW5kIC0gQHBhblRvLnRpbWUuc3RhcnQpXG5cbiAgICBpZiB0IDwgMVxuICAgICAgcmV0dXJuICgoRyAtIEIpLzIpICogdCAqIHQgKyBCXG4gICAgZWxzZVxuICAgICAgdCA9IHQgLSAxXG4gICAgICByZXR1cm4gKChCIC0gRykvMikgKiAodCAqICh0IC0gMikgLSAxKSArIEJcblxuICBwcm9jZXNzTW92ZW1lbnRzOiAoKSA9PlxuICAgIF8ubWFwIEBkaXJlY3Rpb25zLCAoZW5hYmxlZCwgZGlyZWN0aW9uKSA9PlxuICAgICAgQG1vdmUgZGlyZWN0aW9uIGlmIGVuYWJsZWRcblxuICAgIGlmIEBwYW5Uby5hY3RpdmVcbiAgICAgIEBwcm9jZXNzUGFuVG8oKVxuXG4gICAgIyBhZGp1c3QgdGhlIHJvdGF0aW9uIG9mIHRoZSBjb21wYXNzIG5lZWRsZVxuICAgIHJvdGF0aW9uU3RyaW5nID0gXCJyb3RhdGUoI3tAcGFyZW50T2JqZWN0LnJvdGF0aW9uLnl9cmFkKVwiXG4gICAgQGNvbXBhc3NOZWVkbGUuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gcm90YXRpb25TdHJpbmdcbiAgICBAY29tcGFzc05lZWRsZS5zdHlsZS50cmFuc2Zvcm0gPSByb3RhdGlvblN0cmluZ1xuXG4gICAgcmV0dXJuXG5cbiAgc2hvdWxkUmVyZW5kZXI6ID0+XG4gICAgIyBJZiB0aGVyZSBhcmUgc29tZSBkaXJlY3Rpb25zIGFjdGl2ZS4uLlxuICAgIEBncmFiLmFjdGl2ZSBvciBfLnNvbWUoQGRpcmVjdGlvbnMpIG9yIEBwYW5Uby5hY3RpdmVcblxuICBkb1JlbmRlcjogLT5cbiAgICAjIFJlbmRlciB0aGUgc2NlbmVcbiAgICBAcmVuZGVyZXIucmVuZGVyIEBzY2VuZSwgQGNhbWVyYVxuXG4gIHJlbmRlcjogPT5cbiAgICBpZiBAc2hvdWxkUmVyZW5kZXIoKVxuICAgICAgIyBSZXF1ZXN0IHRoZSBhbmltYXRpb24gdG8gcmVwZWF0IG9uY2UgbW9yZVxuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIFRocmVlU2l4dHk6OnJlbmRlci5iaW5kKHRoaXMpXG5cbiAgICAgICMgUHJvY2VzcyBhbGwgdGhlIG1vdmVtZW50c1xuICAgICAgQHByb2Nlc3NNb3ZlbWVudHMoKVxuXG4gICAgICAjIERvIHRoZSByZW5kZXJcbiAgICAgIEBkb1JlbmRlcigpXG5cbiAgICBlbHNlXG4gICAgICAjIEZpbmlzaGVkIHJlbmRlcmluZ1xuICAgICAgQGlzUmVuZGVyaW5nID0gZmFsc2VcblxuICAgIHJldHVyblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdET01Db250ZW50TG9hZGVkJywgLT5cbiAgdHMgPSBuZXcgVGhyZWVTaXh0eSBkb2N1bWVudC5ib2R5LCBbXG4gICAgJ2ltYWdlcy95b2tvaGFtYS9wb3MteC5qcGcnLFxuICAgICdpbWFnZXMveW9rb2hhbWEvbmVnLXguanBnJyxcbiAgICAnaW1hZ2VzL3lva29oYW1hL3Bvcy15LmpwZycsXG4gICAgJ2ltYWdlcy95b2tvaGFtYS9uZWcteS5qcGcnLFxuICAgICdpbWFnZXMveW9rb2hhbWEvcG9zLXouanBnJyxcbiAgICAnaW1hZ2VzL3lva29oYW1hL25lZy16LmpwZydcbiAgXVxuXG4gIHRzLnN0YXJ0KClcblxuICByZXR1cm5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==